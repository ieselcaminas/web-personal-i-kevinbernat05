{% extends 'base.html.twig' %}

{% block title %}Autores{% endblock %}

{% block body %}
<h2>Lista de Autores</h2>

<table border="1" cellspacing="0" cellpadding="8">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Fecha de Nacimiento</th>
            <th>Género</th>
        </tr>
    </thead>
    <tbody>
        {% for autor in autores %}
            <tr>
                <td>{{ autor.nombre }}</td>
                <td>{{ autor.fechaNacimiento|date('d/m/Y') }}</td>
                <td>{{ autor.genero }}</td>

            </tr>
        {% else %}
            <tr>
                <td colspan="3">No hay autores registrados.</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<a href="{{ path('buscar_autores') }}">
    <button>Buscar Autor</button>
    </a>
    <br>

<a href="{{ path('insertar_autor') }}">
    <button>Añadir Autor</button>
</a>

<br>

<!-- Botón para mostrar el desplegable -->
<button onclick="document.getElementById('eliminar-form').style.display='block'">
    Eliminar Autor
</button>

<!-- Formulario oculto por defecto -->
<div id="eliminar-form" style="display:none; margin-top:10px;">
    <form action="{{ path('eliminar_autor') }}" method="post">
        <label for="autor_id">Selecciona un autor:</label>
        <select name="autor_id" id="autor_id" required>
            {% for autor in autores %}
                <option value="{{ autor.id }}">{{ autor.nombre }}</option>
            {% endfor %}
        </select>
        <button type="submit" style="margin-left:10px;">Eliminar</button>
    </form>
</div>

<br>

<!-- Botón para mostrar el desplegable -->
<button type="button" onclick="document.getElementById('editar-autor-form').style.display='block'">
    Editar Autor
</button>

<!-- Formulario oculto por defecto -->
<div id="editar-autor-form" style="display:none; margin-top:10px;">
    <form id="form-editar-autor" onsubmit="redirigirEditarAutor(event)">
        <label for="autor_id_edit">Selecciona un autor:</label>
        <select id="autor_id_edit" name="autor_id" required>
            {% for autor in autores %}
                <option value="{{ autor.id }}">{{ autor.nombre }}</option>
            {% endfor %}
        </select>
        <button type="submit" style="margin-left:10px;">Editar</button>
    </form>
</div>

<script>
function redirigirEditarAutor(event) {
    event.preventDefault();
    const id = document.getElementById('autor_id_edit').value;
    if (id) {
        window.location.href = "{{ path('editar_autor', {'id': 'AUTOR_ID'}) }}".replace('AUTOR_ID', id);
    }
}
</script>
{% endblock %}
